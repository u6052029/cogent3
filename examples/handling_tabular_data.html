
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Data Manipulation using Table &#8212; cogent3 2020.2.7a documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="../_static/require.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Manipulation of Tree Node Objects" href="manipulating_tree_nodes.html" />
    <link rel="prev" title="Map protein alignment gaps to DNA alignment gaps" href="align_codons_to_protein.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">cogent3</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../warning.html">Warning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app/index.html">The <code class="docutils literal notranslate"><span class="pre">apps</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../draw/index.html">Image Gallery</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../library.html">The Library</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../cookbook/index.html">Cookbook</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_file_links.html">Data Files Used in the Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../licenses.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general.html">Posting Bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general.html#citation">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general.html#support">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general.html#search">Search</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../library.html">The Library</a><ul>
  <li><a href="index.html">Usage Examples</a><ul>
      <li>Previous: <a href="align_codons_to_protein.html" title="previous chapter">Map protein alignment gaps to DNA alignment gaps</a></li>
      <li>Next: <a href="manipulating_tree_nodes.html" title="next chapter">Manipulation of Tree Node Objects</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="data-manipulation-using-table">
<h1>Data Manipulation using <code class="docutils literal notranslate"><span class="pre">Table</span></code><a class="headerlink" href="#data-manipulation-using-table" title="Permalink to this headline">¶</a></h1>
<p><em>Section author: Gavin Huttley</em></p>
<p>The toolkit has a <code class="docutils literal notranslate"><span class="pre">Table</span></code> object that can be used for manipulating tabular data. It’s properties can be considered like an ordered 2 dimensional dictionary or tuple with flexible output format capabilities of use for exporting data for import into external applications. Importantly, via the restructured text format one can generate html or latex formatted tables. The <code class="docutils literal notranslate"><span class="pre">table</span></code> module is located within <code class="docutils literal notranslate"><span class="pre">cogent3.util</span></code>. The <code class="docutils literal notranslate"><span class="pre">load_table</span></code> and <code class="docutils literal notranslate"><span class="pre">make_table</span></code> convenience functions are provided as top-level <code class="docutils literal notranslate"><span class="pre">cogent3</span></code> imports.</p>
<div class="section" id="table-creation">
<h2>Table creation<a class="headerlink" href="#table-creation" title="Permalink to this headline">¶</a></h2>
<p>Tables can be created directly using the Table object itself, or a convenience function that handles loading from files. We import both here:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent3</span> <span class="kn">import</span> <span class="n">load_table</span><span class="p">,</span> <span class="n">make_table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent3.util.table</span> <span class="kn">import</span> <span class="n">Table</span>
</pre></div>
</div>
<p>You can create a <code class="docutils literal notranslate"><span class="pre">Table</span></code> with no data.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col 1&quot;</span><span class="p">,</span> <span class="s2">&quot;col 2&quot;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="p">[])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Let’s create a very simple, rather nonsensical, table first. To create a table requires a header series, and a 2D series (either of type <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">dict</span></code>) or a <a class="reference external" href="http://pandas.pydata.org/">pandas DataFrame</a>..</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">column_headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chrom&#39;</span><span class="p">,</span> <span class="s1">&#39;stableid&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The string “chrom” will become the first column heading, “stableid” the second column heading, etc. The data are,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000005893&#39;</span><span class="p">,</span> <span class="mi">1353</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000019485&#39;</span><span class="p">,</span> <span class="mi">1827</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000019102&#39;</span><span class="p">,</span> <span class="mi">999</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000012174&#39;</span><span class="p">,</span> <span class="mi">1599</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000010671&#39;</span><span class="p">,</span> <span class="mi">1977</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000019186&#39;</span><span class="p">,</span> <span class="mi">1554</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000019144&#39;</span><span class="p">,</span> <span class="mi">4185</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000008056&#39;</span><span class="p">,</span> <span class="mi">2307</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000018408&#39;</span><span class="p">,</span> <span class="mi">1383</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSG00000019169&#39;</span><span class="p">,</span> <span class="mi">1698</span><span class="p">]]</span>
<span class="gp">...</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>We create the simplest of tables.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">column_headings</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">==================================</span>
<span class="go">chrom           stableid    length</span>
<span class="go">----------------------------------</span>
<span class="go">    X    ENSG00000005893      1353</span>
<span class="go">    A    ENSG00000019485      1827</span>
<span class="go">    A    ENSG00000019102       999</span>
<span class="go">    X    ENSG00000012174      1599</span>
<span class="go">    X    ENSG00000010671      1977</span>
<span class="go">    A    ENSG00000019186      1554</span>
<span class="go">    A    ENSG00000019144      4185</span>
<span class="go">    X    ENSG00000008056      2307</span>
<span class="go">    A    ENSG00000018408      1383</span>
<span class="go">    A    ENSG00000019169      1698</span>
<span class="go">----------------------------------</span>
</pre></div>
</div>
<p>The format above is referred to as ‘simple’ format in the documentation. Notice that the numbers in this table have 4 decimal places, despite the fact the original data were largely strings and had <code class="docutils literal notranslate"><span class="pre">max</span></code> of 3 decimal places precision. <code class="docutils literal notranslate"><span class="pre">Table</span></code> converts string representations of numbers to their appropriate form when you do <code class="docutils literal notranslate"><span class="pre">str(table)</span></code> or print the table.</p>
<p>We have several things we might want to specify when creating a table: the precision and or format of floating point numbers (integer argument - <code class="docutils literal notranslate"><span class="pre">digits</span></code>), the spacing between columns (integer argument or actual string of whitespace - <code class="docutils literal notranslate"><span class="pre">space</span></code>), title (argument - <code class="docutils literal notranslate"><span class="pre">title</span></code>), and legend (argument - <code class="docutils literal notranslate"><span class="pre">legend</span></code>). Lets modify some of these and provide a title and legend.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">column_headings</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Alignment lengths&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;Some analysis&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">digits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;        &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Alignment lengths</span>
<span class="go">==========================================</span>
<span class="go">chrom               stableid        length</span>
<span class="go">------------------------------------------</span>
<span class="go">    X        ENSG00000005893          1353</span>
<span class="go">    A        ENSG00000019485          1827</span>
<span class="go">    A        ENSG00000019102           999</span>
<span class="go">    X        ENSG00000012174          1599</span>
<span class="go">    X        ENSG00000010671          1977</span>
<span class="go">    A        ENSG00000019186          1554</span>
<span class="go">    A        ENSG00000019144          4185</span>
<span class="go">    X        ENSG00000008056          2307</span>
<span class="go">    A        ENSG00000018408          1383</span>
<span class="go">    A        ENSG00000019169          1698</span>
<span class="go">------------------------------------------</span>
<span class="go">Some analysis</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">repr()</span></code> of a table gives a quick summary.</p>
</div>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">Alignment lengths</span>
<span class="go">==========================================</span>
<span class="go">chrom               stableid        length</span>
<span class="go">------------------------------------------</span>
<span class="go">    X        ENSG00000005893          1353</span>
<span class="go">    A        ENSG00000019485          1827</span>
<span class="go">    A        ENSG00000019102           999</span>
<span class="go">    X        ENSG00000012174          1599</span>
<span class="go">    X        ENSG00000010671          1977</span>
<span class="go">    A        ENSG00000019186          1554</span>
<span class="go">    A        ENSG00000019144          4185</span>
<span class="go">    X        ENSG00000008056          2307</span>
<span class="go">    A        ENSG00000018408          1383</span>
<span class="go">    A        ENSG00000019169          1698</span>
<span class="go">------------------------------------------</span>
<span class="go">Some analysis</span>

<span class="go">10 rows x 3 columns</span>
</pre></div>
</div>
<p>The Table class cannot handle arbitrary python objects, unless they are passed in as strings. Note in this case we now directly pass in the column headings list and the handling of missing data can be explicitly specified..</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))),</span> <span class="s1">&#39;0&#39;</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span>
<span class="gp">... </span>          <span class="n">missing_data</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="go">=======================</span>
<span class="go">           abcd    data</span>
<span class="go">-----------------------</span>
<span class="go">[1, 2, 3, 4, 5]       0</span>
<span class="go">              x     5.0</span>
<span class="go">              y    None</span>
<span class="go">-----------------------</span>
</pre></div>
</div>
<p>Table column headings can be assessed from the <code class="docutils literal notranslate"><span class="pre">table.header</span></code> property</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">t2</span><span class="o">.</span><span class="n">header</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>this cannot be changed.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">TypeError</span>: <span class="n">&#39;tuple&#39; object does not support item assignment</span>
</pre></div>
</div>
<p>If you want to change the header, use the <code class="docutils literal notranslate"><span class="pre">with_new_header</span></code> method. This can be done one column at a time, or as a batch. The returned Table is identical aside from the modified column labels.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod_header</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">with_new_header</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="s1">&#39;ABCD&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">mod_header</span><span class="o">.</span><span class="n">header</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod_header</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">with_new_header</span><span class="p">([</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;ABCD&#39;</span><span class="p">,</span> <span class="s1">&#39;DATA&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mod_header</span><span class="p">)</span>
<span class="go">=======================</span>
<span class="go">           ABCD    DATA</span>
<span class="go">-----------------------</span>
<span class="go">[1, 2, 3, 4, 5]       0</span>
<span class="go">              x     5.0</span>
<span class="go">              y    None</span>
<span class="go">-----------------------</span>
</pre></div>
</div>
<p>Tables may also be created from 2-dimensional dictionaries. In this case, special capabilities are provided to enforce printing rows in a particular order.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d2D</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;edge.parent&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;NineBande&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;edge.1&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;DogFaced&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;Human&#39;</span><span class="p">:</span> <span class="s1">&#39;edge.0&#39;</span><span class="p">,</span> <span class="s1">&#39;edge.0&#39;</span><span class="p">:</span> <span class="s1">&#39;edge.1&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;Mouse&#39;</span><span class="p">:</span> <span class="s1">&#39;edge.1&#39;</span><span class="p">,</span> <span class="s1">&#39;HowlerMon&#39;</span><span class="p">:</span> <span class="s1">&#39;edge.0&#39;</span><span class="p">},</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;NineBande&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;edge.1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;DogFaced&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Human&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;edge.0&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;Mouse&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;HowlerMon&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span> <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;NineBande&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;edge.1&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s1">&#39;DogFaced&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s1">&#39;Human&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s1">&#39;edge.0&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;Mouse&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s1">&#39;HowlerMon&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;NineBande&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;edge.1&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;DogFaced&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;Human&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;edge.0&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;Mouse&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;HowlerMon&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">},</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;NineBande&#39;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span> <span class="s1">&#39;edge.1&#39;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;DogFaced&#39;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span> <span class="s1">&#39;Human&#39;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span> <span class="s1">&#39;edge.0&#39;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span> <span class="s1">&#39;Mouse&#39;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;HowlerMon&#39;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">},</span>
<span class="gp">... </span><span class="s1">&#39;edge.name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Human&#39;</span><span class="p">,</span> <span class="s1">&#39;HowlerMon&#39;</span><span class="p">,</span> <span class="s1">&#39;Mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;NineBande&#39;</span><span class="p">,</span> <span class="s1">&#39;DogFaced&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;edge.0&#39;</span><span class="p">,</span> <span class="s1">&#39;edge.1&#39;</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row_order</span> <span class="o">=</span> <span class="n">d2D</span><span class="p">[</span><span class="s1">&#39;edge.name&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2D</span><span class="p">[</span><span class="s1">&#39;edge.name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">row_order</span><span class="p">,</span> <span class="n">row_order</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;edge.name&#39;</span><span class="p">,</span> <span class="s1">&#39;edge.parent&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">d2D</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">row_order</span><span class="o">=</span><span class="n">row_order</span><span class="p">,</span> <span class="n">missing_data</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">max_width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">row_ids</span><span class="o">=</span><span class="s1">&#39;edge.name&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;My title&#39;</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;legend: this is a nonsense example.&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">==========================================</span>
<span class="go">edge.name        edge.parent        length</span>
<span class="go">------------------------------------------</span>
<span class="go">    Human             edge.0        4.0000</span>
<span class="go">HowlerMon             edge.0        4.0000</span>
<span class="go">    Mouse             edge.1        4.0000</span>
<span class="go">NineBande               root        4.0000</span>
<span class="go"> DogFaced               root        4.0000</span>
<span class="go">   edge.0             edge.1        4.0000</span>
<span class="go">   edge.1               root        4.0000</span>
<span class="go">------------------------------------------</span>

<span class="go">continued: My title</span>
<span class="go">=====================================</span>
<span class="go">edge.name             x             y</span>
<span class="go">-------------------------------------</span>
<span class="go">    Human        1.0000        3.0000</span>
<span class="go">HowlerMon        1.0000        3.0000</span>
<span class="go">    Mouse        1.0000        3.0000</span>
<span class="go">NineBande        1.0000        3.0000</span>
<span class="go"> DogFaced        1.0000        3.0000</span>
<span class="go">   edge.0        1.0000        3.0000</span>
<span class="go">   edge.1        1.0000        3.0000</span>
<span class="go">-------------------------------------</span>

<span class="go">continued: My title</span>
<span class="go">=======================</span>
<span class="go">edge.name             z</span>
<span class="go">-----------------------</span>
<span class="go">    Human        6.0000</span>
<span class="go">HowlerMon        6.0000</span>
<span class="go">    Mouse        6.0000</span>
<span class="go">NineBande        6.0000</span>
<span class="go"> DogFaced        6.0000</span>
<span class="go">   edge.0        6.0000</span>
<span class="go">   edge.1        6.0000</span>
<span class="go">-----------------------</span>

<span class="go">legend: this is a nonsense example.</span>
</pre></div>
</div>
<p>In the above we specify a maximum width of the table, and also specify row identifiers (using <code class="docutils literal notranslate"><span class="pre">row_ids</span></code>, the name to use as row identifiers). This has the effect of forcing the table to wrap when the simple text format is used, but wrapping does not occur for any other format. The <code class="docutils literal notranslate"><span class="pre">row_ids</span></code> is a column containing data for slicing the table by row, and as identifiers are presented in each wrapped sub-table.</p>
<p>Wrapping generates neat looking tables whether or not you index the table rows. We demonstrate here</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent3</span> <span class="kn">import</span> <span class="n">make_table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A/C&#39;</span><span class="p">,</span> <span class="s1">&#39;A/G&#39;</span><span class="p">,</span> <span class="s1">&#39;A/T&#39;</span><span class="p">,</span> <span class="s1">&#39;C/A&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0425</span><span class="p">,</span> <span class="mf">0.1424</span><span class="p">,</span> <span class="mf">0.0226</span><span class="p">,</span> <span class="mf">0.0391</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrap_table</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wrap_table</span><span class="p">)</span>
<span class="go">==========================</span>
<span class="go">   A/C       A/G       A/T</span>
<span class="go">--------------------------</span>
<span class="go">0.0425    0.1424    0.0226</span>
<span class="go">--------------------------</span>

<span class="go">continued:</span>
<span class="go">======</span>
<span class="go">   C/A</span>
<span class="go">------</span>
<span class="go">0.0391</span>
<span class="go">------</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">wrap_table</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<span class="gp">... </span> <span class="n">row_ids</span><span class="o">=</span><span class="s2">&quot;A/C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wrap_table</span><span class="p">)</span>
<span class="go">==========================</span>
<span class="go">   A/C       A/G       A/T</span>
<span class="go">--------------------------</span>
<span class="go">0.0425    0.1424    0.0226</span>
<span class="go">--------------------------</span>

<span class="go">continued:</span>
<span class="go">================</span>
<span class="go">   A/C       C/A</span>
<span class="go">----------------</span>
<span class="go">0.0425    0.0391</span>
<span class="go">----------------</span>
</pre></div>
</div>
<p>We can also customise the formatting of individual columns.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rows</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;NP_003077_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">2.5386013224378985</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="s1">&#39;NP_004893_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">0.12135142635634111e+06</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="s1">&#39;NP_005079_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">0.95165949788861326e+07</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="s1">&#39;NP_005500_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">0.73827030202664901e-07</span><span class="p">),</span>
<span class="gp">... </span><span class="p">(</span><span class="s1">&#39;NP_055852_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">1.0933217708952725e+07</span><span class="p">))</span>
</pre></div>
</div>
<p>We first create a table and show the default formatting behaviour for <code class="docutils literal notranslate"><span class="pre">Table</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t46</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;Gene&#39;</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t46</span><span class="p">)</span>
<span class="go">===============================================</span>
<span class="go">                  Gene    Type               LR</span>
<span class="go">-----------------------------------------------</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con           2.5386</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con      121351.4264</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con     9516594.9789</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con           0.0000</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con    10933217.7090</span>
<span class="go">-----------------------------------------------</span>
</pre></div>
</div>
<p>We then format the <code class="docutils literal notranslate"><span class="pre">LR</span></code> column to use a scientific number format.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t46</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;Gene&#39;</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t46</span><span class="o">.</span><span class="n">format_column</span><span class="p">(</span><span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="s2">&quot;.4e&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t46</span><span class="p">)</span>
<span class="go">============================================</span>
<span class="go">                  Gene    Type            LR</span>
<span class="go">--------------------------------------------</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con    2.5386e+00</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con    1.2135e+05</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con    9.5166e+06</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con    7.3827e-08</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con    1.0933e+07</span>
<span class="go">--------------------------------------------</span>
</pre></div>
</div>
<p>It is safe to directly modify certain attributes, such as the title, legend and white space separating columns, which we do for the <code class="docutils literal notranslate"><span class="pre">t46</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t46</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;A new title&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t46</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="s2">&quot;A new legend&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t46</span><span class="o">.</span><span class="n">space</span> <span class="o">=</span> <span class="s1">&#39;  &#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t46</span><span class="p">)</span>
<span class="go">A new title</span>
<span class="go">========================================</span>
<span class="go">                  Gene  Type          LR</span>
<span class="go">----------------------------------------</span>
<span class="go">NP_003077_hs_mm_rn_dna   Con  2.5386e+00</span>
<span class="go">NP_004893_hs_mm_rn_dna   Con  1.2135e+05</span>
<span class="go">NP_005079_hs_mm_rn_dna   Con  9.5166e+06</span>
<span class="go">NP_005500_hs_mm_rn_dna   Con  7.3827e-08</span>
<span class="go">NP_055852_hs_mm_rn_dna   Con  1.0933e+07</span>
<span class="go">----------------------------------------</span>
<span class="go">A new legend</span>
</pre></div>
</div>
<p>We can provide settings for multiple columns.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;edge.name&#39;</span><span class="p">,</span> <span class="s1">&#39;edge.parent&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">d2D</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">row_order</span><span class="o">=</span><span class="n">row_order</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span><span class="o">.</span><span class="n">format_column</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.1e</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span><span class="o">.</span><span class="n">format_column</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span>
<span class="go">===============================================================</span>
<span class="go">edge.name    edge.parent    length          x       y         z</span>
<span class="go">---------------------------------------------------------------</span>
<span class="go">    Human         edge.0    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">HowlerMon         edge.0    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">    Mouse         edge.1    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">NineBande           root    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go"> DogFaced           root    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">   edge.0         edge.1    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">   edge.1           root    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">---------------------------------------------------------------</span>
</pre></div>
</div>
<p>In some cases, the contents of a column can be of different types. In this instance, rather than passing a column template we pass a reference to a function that will handle this complexity. To illustrate this we will define a function that formats floating point numbers, but returns everything else as is.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">formatcol</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">val</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">val</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">val</span>
</pre></div>
</div>
<p>We apply this to a table with mixed string, integer and floating point data.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t6</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;ColHead&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;cc&#39;</span><span class="p">]],</span>
<span class="gp">... </span>           <span class="n">column_templates</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">ColHead</span><span class="o">=</span><span class="n">formatcol</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t6</span><span class="p">)</span>
<span class="go">=======</span>
<span class="go">ColHead</span>
<span class="go">-------</span>
<span class="go">      a</span>
<span class="go">      1</span>
<span class="go">   0.30</span>
<span class="go">     cc</span>
<span class="go">-------</span>
</pre></div>
</div>
<div class="section" id="creating-a-table-from-a-pandas-dataframe">
<h3>Creating a Table from a pandas DataFrame<a class="headerlink" href="#creating-a-table-from-a-pandas-dataframe" title="Permalink to this headline">¶</a></h3>
<p>Assign the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> instance to the <code class="docutils literal notranslate"><span class="pre">data_frame</span></code> argument.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a  b</span>
<span class="go">0  0  1</span>
<span class="go">1  3  7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_as_table</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">data_frame</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df_as_table</span><span class="p">)</span>
<span class="go">======</span>
<span class="go">a    b</span>
<span class="go">------</span>
<span class="go">0    1</span>
<span class="go">3    7</span>
<span class="go">------</span>
</pre></div>
</div>
</div>
<div class="section" id="representation-of-tables">
<h3>Representation of tables<a class="headerlink" href="#representation-of-tables" title="Permalink to this headline">¶</a></h3>
<p>The representation formatting provides a quick overview of a table’s dimensions and it’s contents. We show this for a table with 3 columns and multiple rows</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t46</span>
<span class="go">A new title</span>
<span class="go">========================================</span>
<span class="go">                  Gene  Type          LR</span>
<span class="go">----------------------------------------</span>
<span class="go">NP_003077_hs_mm_rn_dna   Con  2.5386e+00</span>
<span class="go">NP_004893_hs_mm_rn_dna   Con  1.2135e+05</span>
<span class="go">NP_005079_hs_mm_rn_dna   Con  9.5166e+06</span>
<span class="go">NP_005500_hs_mm_rn_dna   Con  7.3827e-08</span>
<span class="go">NP_055852_hs_mm_rn_dna   Con  1.0933e+07</span>
<span class="go">----------------------------------------</span>
<span class="go">A new legend</span>

<span class="go">5 rows x 3 columns</span>
</pre></div>
</div>
<p>and larger</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span>
<span class="go">===============================================================</span>
<span class="go">edge.name    edge.parent    length          x       y         z</span>
<span class="go">---------------------------------------------------------------</span>
<span class="go">    Human         edge.0    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">HowlerMon         edge.0    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">    Mouse         edge.1    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">NineBande           root    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go"> DogFaced           root    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">   edge.0         edge.1    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">   edge.1           root    4.0000    1.0e+00    3.00    6.0000</span>
<span class="go">---------------------------------------------------------------</span>

<span class="go">7 rows x 6 columns</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>within a script use <code class="docutils literal notranslate"><span class="pre">print(repr(t3))</span></code> to get the same representation.</p>
</div>
</div>
</div>
<div class="section" id="table-output">
<h2>Table output<a class="headerlink" href="#table-output" title="Permalink to this headline">¶</a></h2>
<p>Table can output in multiple formats, including restructured text or ‘rest’ and delimited. These can be obtained using the <code class="docutils literal notranslate"><span class="pre">to_string</span></code> method and <code class="docutils literal notranslate"><span class="pre">format</span></code> argument as follows. Using table <code class="docutils literal notranslate"><span class="pre">t</span></code> from above,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;rest&#39;</span><span class="p">))</span>
<span class="go">+----------------------------------+</span>
<span class="go">|        Alignment lengths         |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">| chrom |        stableid | length |</span>
<span class="go">+=======+=================+========+</span>
<span class="go">|     X | ENSG00000005893 |   1353 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">|     A | ENSG00000019485 |   1827 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">|     A | ENSG00000019102 |    999 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">|     X | ENSG00000012174 |   1599 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">|     X | ENSG00000010671 |   1977 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">|     A | ENSG00000019186 |   1554 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">|     A | ENSG00000019144 |   4185 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">|     X | ENSG00000008056 |   2307 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">|     A | ENSG00000018408 |   1383 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">|     A | ENSG00000019169 |   1698 |</span>
<span class="go">+-------+-----------------+--------+</span>
<span class="go">| Some analysis                    |</span>
<span class="go">+----------------------------------+</span>
</pre></div>
</div>
<p>or Markdown format</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;md&#39;</span><span class="p">))</span>
<span class="go">| chrom |        stableid | length |</span>
<span class="go">|-------|-----------------|--------|</span>
<span class="go">|     X | ENSG00000005893 |   1353 |</span>
<span class="go">|     A | ENSG00000019485 |   1827 |</span>
<span class="go">|     A | ENSG00000019102 |    999 |</span>
<span class="go">|     X | ENSG00000012174 |   1599 |...</span>
</pre></div>
</div>
<p>which can also take an optional <cite>justify</cite> argument. The latter must be a series with a value for each column. (It only affects the html display of a Markdown table.)</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;md&#39;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;lcr&#39;</span><span class="p">))</span>
<span class="go">| chrom |        stableid | length |</span>
<span class="go">|:------|:---------------:|-------:|</span>
<span class="go">|     X | ENSG00000005893 |   1353 |</span>
<span class="go">|     A | ENSG00000019485 |   1827 |</span>
<span class="go">|     A | ENSG00000019102 |    999 |</span>
<span class="go">|     X | ENSG00000012174 |   1599 |...</span>
</pre></div>
</div>
<p>where the values <cite>lcr</cite> correspond to left, centre and right justification.</p>
<p>In the case of Markdown, the pipe character (<code class="docutils literal notranslate"><span class="pre">|</span></code>) is special and so cells containing it must be escaped.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">md_table</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;val1&quot;</span><span class="p">,</span> <span class="s2">&quot;val2&quot;</span><span class="p">],</span>
<span class="gp">... </span>                           <span class="p">[</span><span class="s2">&quot;has | symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;val4&quot;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">md_table</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;md&#39;</span><span class="p">))</span>
<span class="go">|             a |    b |</span>
<span class="go">|---------------|------|</span>
<span class="go">|          val1 | val2 |</span>
<span class="go">| has \| symbol | val4 |</span>
</pre></div>
</div>
<p>Arguments such as <code class="docutils literal notranslate"><span class="pre">space</span></code> have no effect in this case. The table may also be written to file in any of the available formats (latex, simple text, html, pickle) or using a custom separator (such as a comma or tab). This makes it convenient to get data into other applications (such as R or a spreadsheet program).</p>
<p>The display format can be specified for a <code class="docutils literal notranslate"><span class="pre">Table</span></code> using any valid argument to <code class="docutils literal notranslate"><span class="pre">to_string()</span></code>. For instance, we can make a <code class="docutils literal notranslate"><span class="pre">Table</span></code> instance that defaults to Markdown display.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">md_table</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;val1&quot;</span><span class="p">,</span> <span class="s2">&quot;val2&quot;</span><span class="p">],</span>
<span class="gp">... </span>                           <span class="p">[</span><span class="s2">&quot;has | symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;val4&quot;</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;md&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">md_table</span><span class="p">)</span>
<span class="go">|             a |    b |</span>
<span class="go">|---------------|------|</span>
<span class="go">|          val1 | val2 |</span>
<span class="go">| has \| symbol | val4 |</span>
</pre></div>
</div>
<p>This can be changed by modifying the <cite>format</cite> attribute, for example</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">md_table</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;rst&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">md_table</span><span class="p">)</span>
<span class="go">+--------------+------+</span>
<span class="go">|            a |    b |</span>
<span class="go">+==============+======+</span>
<span class="go">|         val1 | val2 |</span>
<span class="go">+--------------+------+</span>
<span class="go">| has | symbol | val4 |</span>
<span class="go">+--------------+------+</span>
</pre></div>
</div>
<p>Here is the latex format, note how the title and legend are joined into the latex table caption. We also provide optional arguments for the column alignment (fist column left aligned, second column right aligned and remaining columns centred) and a label for table referencing.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;tex&#39;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;lrcccc&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;table:example&quot;</span><span class="p">))</span>
<span class="go">\begin{table}[htp!]</span>
<span class="go">\centering</span>
<span class="go">\begin{tabular}{ l r c c c c }</span>
<span class="go">\hline</span>
<span class="go">\bf{edge.name} &amp; \bf{edge.parent} &amp; \bf{length} &amp; \bf{x} &amp; \bf{y} &amp; \bf{z} \\</span>
<span class="go">\hline</span>
<span class="go">\hline</span>
<span class="go">    Human &amp;      edge.0 &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">HowlerMon &amp;      edge.0 &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">    Mouse &amp;      edge.1 &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">NineBande &amp;        root &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go"> DogFaced &amp;        root &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">   edge.0 &amp;      edge.1 &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">   edge.1 &amp;        root &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">\hline</span>
<span class="go">\end{tabular}</span>
<span class="go">\label{table:example}</span>
<span class="go">\end{table}</span>
</pre></div>
</div>
<p>More complex latex table justifying is also possible. Specifying the width of individual columns requires passing in a series (list or tuple) of justification commands. In the following we introduce the command for specific columns widths.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;tex&#39;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">,</span><span class="s2">&quot;p</span><span class="si">{3cm}</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">]))</span>
<span class="go">\begin{table}[htp!]</span>
<span class="go">\centering</span>
<span class="go">\begin{tabular}{ l p{3cm} c c c c }</span>
<span class="go">\hline</span>
<span class="go">\bf{edge.name} &amp; \bf{edge.parent} &amp; \bf{length} &amp; \bf{x} &amp; \bf{y} &amp; \bf{z} \\</span>
<span class="go">\hline</span>
<span class="go">\hline</span>
<span class="go">    Human &amp;      edge.0 &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">HowlerMon &amp;      edge.0 &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">    Mouse &amp;      edge.1 &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">NineBande &amp;        root &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go"> DogFaced &amp;        root &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">   edge.0 &amp;      edge.1 &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">   edge.1 &amp;        root &amp; 4.0000 &amp; 1.0e+00 &amp; 3.00 &amp; 6.0000 \\</span>
<span class="go">\hline</span>
<span class="go">\end{tabular}</span>
<span class="go">\end{table}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
<span class="go">edge.name,edge.parent,length,      x,   y,     z</span>
<span class="go">    Human,     edge.0,4.0000,1.0e+00,3.00,6.0000</span>
<span class="go">HowlerMon,     edge.0,4.0000,1.0e+00,3.00,6.0000</span>
<span class="go">    Mouse,     edge.1,4.0000,1.0e+00,3.00,6.0000</span>
<span class="go">NineBande,       root,4.0000,1.0e+00,3.00,6.0000</span>
<span class="go"> DogFaced,       root,4.0000,1.0e+00,3.00,6.0000</span>
<span class="go">   edge.0,     edge.1,4.0000,1.0e+00,3.00,6.0000</span>
<span class="go">   edge.1,       root,4.0000,1.0e+00,3.00,6.0000</span>
</pre></div>
</div>
<p>You can specify any standard text character that will work with your desired target. Useful separators are tabs (<code class="docutils literal notranslate"><span class="pre">\t</span></code>), or pipes (<code class="docutils literal notranslate"><span class="pre">|</span></code>). If <code class="docutils literal notranslate"><span class="pre">Table</span></code> encounters the specified separator character within a cell, it wraps the cell in quotes – a standard approach to facilitate import by other applications. We will illustrate this with <code class="docutils literal notranslate"><span class="pre">t2</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
<span class="go">           abcd, data</span>
<span class="go">&quot;[1, 2, 3, 4, 5]&quot;,    0</span>
<span class="go">              x,  5.0</span>
<span class="go">              y, None</span>
</pre></div>
</div>
<p>Note that I introduced an extra space after the column just to make the result more readable in this example.</p>
<p>Test the writing of phylip distance matrix format.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mf">0.088337278874079342</span><span class="p">,</span> <span class="mf">0.18848582712597683</span><span class="p">,</span>
<span class="gp">... </span> <span class="mf">0.44084000179091454</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mf">0.088337278874079342</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="gp">... </span> <span class="mf">0.088337278874079342</span><span class="p">,</span> <span class="mf">0.44083999937417828</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mf">0.18848582712597683</span><span class="p">,</span>
<span class="gp">... </span> <span class="mf">0.088337278874079342</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mf">0.44084000179090932</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span>
<span class="gp">... </span> <span class="mf">0.44084000179091454</span><span class="p">,</span> <span class="mf">0.44083999937417828</span><span class="p">,</span> <span class="mf">0.44084000179090932</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;seq1/2&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">row_ids</span><span class="o">=</span><span class="s1">&#39;seq1/2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;phylip&#39;</span><span class="p">))</span>
<span class="go">   4</span>
<span class="go">a           0.0000  0.0883  0.1885  0.4408</span>
<span class="go">c           0.0883  0.0000  0.0883  0.4408</span>
<span class="go">b           0.1885  0.0883  0.0000  0.4408</span>
<span class="go">e           0.4408  0.4408  0.4408  0.0000</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">to_string</span></code> method also provides generic html generation via the restructured text format. The <code class="docutils literal notranslate"><span class="pre">to_rich_html</span></code> method can be used to generate the html table element by itself, with greater control over formatting. Specifically, users can provide custom callback functions to the <code class="docutils literal notranslate"><span class="pre">row_cell_func</span></code> and <code class="docutils literal notranslate"><span class="pre">header_cell_func</span></code> arguments to control in detail the formatting of table elements, or use the simpler dictionary based <code class="docutils literal notranslate"><span class="pre">element_formatters</span></code> approach. We use the above <code class="docutils literal notranslate"><span class="pre">dist</span></code> table to provide a specific callback that will set the background color for diagonal cells. We first write a function that takes the cell value and coordinates, returning the html formmatted text.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">format_cell</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">bgcolor</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39; bgcolor=&quot;#0055ff&quot;&#39;</span><span class="p">][</span><span class="n">value</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="s1">&#39;&lt;td</span><span class="si">%s</span><span class="s1">&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bgcolor</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>We then call the method, without this argument, then with it.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">straight_html</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">to_rich_html</span><span class="p">(</span><span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">straight_html</span><span class="p">)</span>
<span class="go">&lt;table&gt;&lt;thead style=&quot;font-weight: bold;&quot;...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rich_html</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">to_rich_html</span><span class="p">(</span><span class="n">row_cell_func</span><span class="o">=</span><span class="n">format_cell</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rich_html</span><span class="p">)</span>
<span class="go">&lt;table&gt;</span>
<span class="go">&lt;thead style=&quot;font-weight: bold;&quot;&gt;</span>
<span class="go">&lt;th&gt;seq1/2&lt;/th&gt;</span>
<span class="go">&lt;th&gt;a&lt;/th&gt;</span>
<span class="go">&lt;th&gt;c&lt;/th&gt;</span>
<span class="go">&lt;th&gt;b&lt;/th&gt;</span>
<span class="go">&lt;th&gt;e&lt;/th&gt;</span>
<span class="go">&lt;/thead&gt;</span>
<span class="go">&lt;tbody&gt;</span>
<span class="go">&lt;tr&gt;</span>
<span class="go">&lt;td&gt;a&lt;/td&gt;</span>
<span class="go">&lt;td bgcolor=&quot;#0055ff&quot;&gt;&lt;/td&gt;</span>
<span class="go">&lt;td&gt;0.0883&lt;/td&gt;...</span>
</pre></div>
</div>
</div>
<div class="section" id="convert-table-to-pandas-dataframe">
<h2>Convert Table to pandas DataFrame<a class="headerlink" href="#convert-table-to-pandas-dataframe" title="Permalink to this headline">¶</a></h2>
<p>If you have <code class="docutils literal notranslate"><span class="pre">pandas</span></code> installed, you can convert a <code class="docutils literal notranslate"><span class="pre">Table</span></code> instance to a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbl</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">tbl</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   a  b</span>
<span class="go">0  0  1</span>
<span class="go">1  3  7</span>
</pre></div>
</div>
</div>
<div class="section" id="exporting-bedgraph-format">
<h2>Exporting bedGraph format<a class="headerlink" href="#exporting-bedgraph-format" title="Permalink to this headline">¶</a></h2>
<p>One export format available is <a class="reference external" href="https://cgwb.nci.nih.gov/goldenPath/help/bedgraph.html">bedGraph</a>. This format can be used for viewing data as annotation track in a genome browser. This format allows for unequal spans and merges adjacent spans with the same value. The format has many possible arguments that modify the appearance in the genome browser. For this example we just create a simple data set.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mf">1.123</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mf">1.123</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mf">1.123</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mf">1.123</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mf">1.123</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mf">1.123</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mf">1.123</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mf">1.123</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">155</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">155</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">158</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">158</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bgraph</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;chrom&#39;</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="n">data</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bgraph</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;bedgraph&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;test track&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;test of bedgraph&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span> 
<span class="go">track type=bedGraph name=&quot;test track&quot; description=&quot;test of bedgraph&quot; color=255,0,0 graphType=bar</span>
<span class="go">1   100     108     1.12</span>
<span class="go">1   108     118     1.00</span>
<span class="go">1   118     161     2.00</span>
</pre></div>
</div>
<p>The bedgraph formatter defaults to rounding values to 2 decimal places. You can adjust that precision using the <code class="docutils literal notranslate"><span class="pre">digits</span></code> argument.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bgraph</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;bedgraph&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;test track&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;test of bedgraph&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">digits</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> 
<span class="go">track type=bedGraph name=&quot;test track&quot; description=&quot;test of bedgraph&quot; color=255,0,0 graphType=bar</span>
<span class="go">1   100     118     1.00</span>
<span class="go">1   118     161     2.00</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Writing files in bedgraph format is done using the <code class="docutils literal notranslate"><span class="pre">write(format='bedgraph',</span> <span class="pre">name='test</span> <span class="pre">track',</span> <span class="pre">description='test</span> <span class="pre">of</span> <span class="pre">bedgraph',</span> <span class="pre">color=(255,0,0))</span></code>.</p>
</div>
</div>
<div class="section" id="saving-a-table-for-reloading">
<h2>Saving a table for reloading<a class="headerlink" href="#saving-a-table-for-reloading" title="Permalink to this headline">¶</a></h2>
<p>Saving a table object to file for later reloading can be done using the standard <code class="docutils literal notranslate"><span class="pre">write</span></code> method and <code class="docutils literal notranslate"><span class="pre">filename</span></code> argument to the <code class="docutils literal notranslate"><span class="pre">Table</span></code> constructor, specifying any of the formats supported by <code class="docutils literal notranslate"><span class="pre">to_string</span></code>. The table loading will recreate a table from raw data located at <code class="docutils literal notranslate"><span class="pre">filename</span></code>. To illustrate this, we first write out the table <code class="docutils literal notranslate"><span class="pre">t3</span></code> in <code class="docutils literal notranslate"><span class="pre">pickle</span></code> format, then the table <code class="docutils literal notranslate"><span class="pre">t2</span></code> in a csv (comma separated values format). We then remove it’s header and write/reload as a tsv (tab separated values format).</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;edge.name&#39;</span><span class="p">,</span> <span class="s1">&#39;edge.parent&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">d2D</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">row_order</span><span class="o">=</span><span class="n">row_order</span><span class="p">,</span> <span class="n">missing_data</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">max_width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">row_ids</span><span class="o">=</span><span class="s1">&#39;edge.name&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;My title&#39;</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;legend: this is a nonsense example.&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;t3.pickle&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3_loaded</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s2">&quot;t3.pickle&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3_loaded</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">==========================================</span>
<span class="go">edge.name        edge.parent        length</span>
<span class="go">------------------------------------------</span>
<span class="go">    Human             edge.0        4.0000</span>
<span class="go">HowlerMon             edge.0        4.0000</span>
<span class="go">    Mouse             edge.1        4.0000</span>
<span class="go">NineBande               root        4.0000</span>
<span class="go"> DogFaced               root        4.0000</span>
<span class="go">   edge.0             edge.1        4.0000</span>
<span class="go">   edge.1               root        4.0000</span>
<span class="go">------------------------------------------</span>

<span class="go">continued: My title</span>
<span class="go">=====================================</span>
<span class="go">edge.name             x             y</span>
<span class="go">-------------------------------------</span>
<span class="go">    Human        1.0000        3.0000</span>
<span class="go">HowlerMon        1.0000        3.0000</span>
<span class="go">    Mouse        1.0000        3.0000</span>
<span class="go">NineBande        1.0000        3.0000</span>
<span class="go"> DogFaced        1.0000        3.0000</span>
<span class="go">   edge.0        1.0000        3.0000</span>
<span class="go">   edge.1        1.0000        3.0000</span>
<span class="go">-------------------------------------</span>

<span class="go">continued: My title</span>
<span class="go">=======================</span>
<span class="go">edge.name             z</span>
<span class="go">-----------------------</span>
<span class="go">    Human        6.0000</span>
<span class="go">HowlerMon        6.0000</span>
<span class="go">    Mouse        6.0000</span>
<span class="go">NineBande        6.0000</span>
<span class="go"> DogFaced        6.0000</span>
<span class="go">   edge.0        6.0000</span>
<span class="go">   edge.1        6.0000</span>
<span class="go">-----------------------</span>

<span class="go">legend: this is a nonsense example.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="nb">str</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="s1">&#39;0&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">missing_data</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A </span><span class="se">\n</span><span class="s1">title&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;t2.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2_loaded</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;t2.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_title</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2_loaded</span><span class="p">)</span>
<span class="go">A</span>
<span class="go">title</span>
<span class="go">=========================</span>
<span class="go">           abcd      data</span>
<span class="go">-------------------------</span>
<span class="go">[1, 2, 3, 4, 5]         0</span>
<span class="go">              x    5.0000</span>
<span class="go">              y</span>
<span class="go">-------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;t2.tsv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2_loaded</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;t2.tsv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2_loaded</span><span class="p">)</span>
<span class="go">=========================</span>
<span class="go">           abcd      data</span>
<span class="go">-------------------------</span>
<span class="go">[1, 2, 3, 4, 5]         0</span>
<span class="go">              x    5.0000</span>
<span class="go">              y</span>
<span class="go">-------------------------</span>
</pre></div>
</div>
<p>Note the <code class="docutils literal notranslate"><span class="pre">missing_data</span></code> attribute is not saved in the delimited format, but is in the <code class="docutils literal notranslate"><span class="pre">pickle</span></code> format. In the next case, I’m going to override the digits format on reloading of the table.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="nb">str</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="s1">&#39;0&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">missing_data</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A </span><span class="se">\n</span><span class="s1">title&#39;</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;And</span><span class="se">\n</span><span class="s2">a legend too&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;t2.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2_loaded</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;t2.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_title</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">with_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">digits</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2_loaded</span><span class="p">)</span> 
<span class="go">A</span>
<span class="go">title</span>
<span class="go">=======================</span>
<span class="go">           abcd    data</span>
<span class="go">-----------------------</span>
<span class="go">[1, 2, 3, 4, 5]       0</span>
<span class="go">              x    5.00</span>
<span class="go">              y</span>
<span class="go">-----------------------</span>
<span class="go">And</span>
<span class="go">a legend too</span>
</pre></div>
</div>
<p>A few things to note about the delimited file saving: formatting arguments are lost in saving to a delimited format; the <code class="docutils literal notranslate"><span class="pre">header</span></code> argument specifies whether the first line of the file should be treated as the header; the <code class="docutils literal notranslate"><span class="pre">with_title</span></code> and <code class="docutils literal notranslate"><span class="pre">with_legend</span></code> arguments are necessary if the file contains them, otherwise they become the header or part of the table. Importantly, if you wish to preserve numerical precision use the <code class="docutils literal notranslate"><span class="pre">pickle</span></code> format.</p>
<p><code class="docutils literal notranslate"><span class="pre">pickle</span></code> can load a useful object from the pickled <code class="docutils literal notranslate"><span class="pre">Table</span></code> by itself, without needing to know anything about the <code class="docutils literal notranslate"><span class="pre">Table</span></code> class.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;t3.pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pickled</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">pickled</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[&#39;data&#39;, &#39;init_table&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pickled</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s2">&quot;columns&quot;</span><span class="p">][</span><span class="s2">&quot;length&quot;</span><span class="p">]</span>
<span class="go">{&#39;values&#39;: [4.0, 4.0, 4.0, 4.0, 4.0, 4.0, 4.0], &#39;dtype&#39;: &#39;float64&#39;}</span>
</pre></div>
</div>
<p>We can read in a delimited format using a custom reader. There are two approaches. The first one allows specifying different type conversions for different columns. The second allows specifying a whole line-based parser.</p>
<p>You can also read and write tables in gzip compressed format. This can be done simply by ending a filename with ‘.gz’ or specifying <code class="docutils literal notranslate"><span class="pre">compress=True</span></code>. We write a compressed file the two different ways and read it back in.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;t2.csv.gz&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2_gz</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;t2.csv.gz&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">with_title</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">with_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2_gz</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">t2</span><span class="o">.</span><span class="n">shape</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;t2.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2_gz</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;t2.csv.gz&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">with_title</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">with_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2_gz</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">t2</span><span class="o">.</span><span class="n">shape</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="section" id="defining-a-custom-reader-with-type-conversion-for-each-column">
<h3>Defining a custom reader with type conversion for each column<a class="headerlink" href="#defining-a-custom-reader-with-type-conversion-for-each-column" title="Permalink to this headline">¶</a></h3>
<p>We convert columns 2-5 to floats by specifying a field convertor. We then create a reader, specifying the data (below a list but can be a file) properties. Note that if no convertor is provided all data are returned as strings. We can also provide this reader to the <code class="docutils literal notranslate"><span class="pre">Table</span></code> constructor for a more direct way of opening such files. In this case, <code class="docutils literal notranslate"><span class="pre">Table</span></code> assumes there is a header row and nothing else.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent3.parse.table</span> <span class="kn">import</span> <span class="n">ConvertFields</span><span class="p">,</span> <span class="n">SeparatorFormatParser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">t3</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comma_sep</span> <span class="o">=</span> <span class="n">t3</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">comma_sep</span><span class="p">)</span>
<span class="go">[&#39;edge.name,edge.parent,length,     x,     y,     z&#39;, &#39;    Human,    ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">converter</span> <span class="o">=</span> <span class="n">ConvertFields</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="nb">float</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">float</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="nb">float</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">float</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">SeparatorFormatParser</span><span class="p">(</span><span class="n">with_header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">converter</span><span class="o">=</span><span class="n">converter</span><span class="p">,</span>
<span class="gp">... </span>     <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comma_sep</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">(</span><span class="n">comma_sep</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">comma_sep</span><span class="p">)</span>
<span class="go">[[&#39;edge.name&#39;, &#39;edge.parent&#39;, &#39;length&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;], [&#39;Human&#39;,...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;t3.tab&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">SeparatorFormatParser</span><span class="p">(</span><span class="n">with_header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">converter</span><span class="o">=</span><span class="n">converter</span><span class="p">,</span>
<span class="gp">... </span>     <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3a</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s2">&quot;t3.tab&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="n">reader</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;new title&quot;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">space</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3a</span><span class="p">)</span>
<span class="go">new title</span>
<span class="go">======================================================</span>
<span class="go">edge.name  edge.parent  length       x       y       z</span>
<span class="go">------------------------------------------------------</span>
<span class="go">    Human       edge.0  4.0000  1.0000  3.0000  6.0000</span>
<span class="go">HowlerMon       edge.0  4.0000  1.0000  3.0000  6.0000</span>
<span class="go">    Mouse       edge.1  4.0000  1.0000  3.0000  6.0000</span>
<span class="go">NineBande         root  4.0000  1.0000  3.0000  6.0000</span>
<span class="go"> DogFaced         root  4.0000  1.0000  3.0000  6.0000</span>
<span class="go">   edge.0       edge.1  4.0000  1.0000  3.0000  6.0000</span>
<span class="go">   edge.1         root  4.0000  1.0000  3.0000  6.0000</span>
<span class="go">------------------------------------------------------</span>
</pre></div>
</div>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">SeparatorFormatParser</span></code> to ignore reading certain lines by using a callback function. We illustrate this using the above data, skipping any rows with <code class="docutils literal notranslate"><span class="pre">edge.name</span></code> starting with <code class="docutils literal notranslate"><span class="pre">edge</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">ignore_internal_nodes</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;edge&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">SeparatorFormatParser</span><span class="p">(</span><span class="n">with_header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">converter</span><span class="o">=</span><span class="n">converter</span><span class="p">,</span>
<span class="gp">... </span>     <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="n">ignore_internal_nodes</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tips</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s2">&quot;t3.tab&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="n">reader</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tips</span><span class="p">)</span>
<span class="go">=============================================</span>
<span class="go">edge.name  edge.parent  length    x    y    z</span>
<span class="go">---------------------------------------------</span>
<span class="go">    Human       edge.0     4.0  1.0  3.0  6.0</span>
<span class="go">HowlerMon       edge.0     4.0  1.0  3.0  6.0</span>
<span class="go">    Mouse       edge.1     4.0  1.0  3.0  6.0</span>
<span class="go">NineBande         root     4.0  1.0  3.0  6.0</span>
<span class="go"> DogFaced         root     4.0  1.0  3.0  6.0</span>
<span class="go">---------------------------------------------</span>
</pre></div>
</div>
<p>We can also limit the amount of data to be read in, very handy for checking large files.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3a</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s2">&quot;t3.tab&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3a</span><span class="p">)</span>
<span class="go">================================================================</span>
<span class="go">edge.name    edge.parent    length         x         y         z</span>
<span class="go">----------------------------------------------------------------</span>
<span class="go">    Human         edge.0    4.0000    1.0000    3.0000    6.0000</span>
<span class="go">HowlerMon         edge.0    4.0000    1.0000    3.0000    6.0000</span>
<span class="go">    Mouse         edge.1    4.0000    1.0000    3.0000    6.0000</span>
<span class="go">----------------------------------------------------------------</span>
</pre></div>
</div>
<p>Limiting should also work when <code class="docutils literal notranslate"><span class="pre">static_column_types</span></code> is invoked</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3a</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s2">&quot;t3.tab&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">static_column_types</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>or when</p>
<p>In the above example, the data type in a column is static, e.g. all values in <code class="docutils literal notranslate"><span class="pre">x</span></code> are floats. Rather than providing a custom reader, you can get the <code class="docutils literal notranslate"><span class="pre">Table</span></code> to construct such a reader based on the first data row using the <code class="docutils literal notranslate"><span class="pre">static_column_types</span></code> argument.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3a</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s2">&quot;t3.tab&quot;</span><span class="p">,</span> <span class="n">static_column_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3a</span><span class="p">)</span>
<span class="go">=======================================================</span>
<span class="go">edge.name    edge.parent    length      x      y      z</span>
<span class="go">-------------------------------------------------------</span>
<span class="go">    Human         edge.0       4.0    1.0    3.0    6.0</span>
<span class="go">HowlerMon         edge.0       4.0    1.0    3.0    6.0</span>
<span class="go">    Mouse         edge.1       4.0    1.0    3.0    6.0</span>
<span class="go">NineBande           root       4.0    1.0    3.0    6.0</span>
<span class="go"> DogFaced           root       4.0    1.0    3.0    6.0</span>
<span class="go">   edge.0         edge.1       4.0    1.0    3.0    6.0</span>
<span class="go">   edge.1           root       4.0    1.0    3.0    6.0</span>
<span class="go">-------------------------------------------------------</span>
</pre></div>
</div>
<p>If you invoke the <code class="docutils literal notranslate"><span class="pre">static_column_types</span></code> argument and the column data are not static, you’ll get back a string type.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t3b</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3b</span><span class="p">)</span>
<span class="go">======</span>
<span class="go">A    B</span>
<span class="go">------</span>
<span class="go">1    1</span>
<span class="go">a    2</span>
<span class="go">------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3b</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;test3b.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3b</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s1">&#39;test3b.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">static_column_types</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3b</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
<span class="go">array([&#39;1&#39;, &#39;a&#39;], dtype=&#39;&lt;U1&#39;)</span>
</pre></div>
</div>
<p>We also test the reader function for a tab delimited format with missing data at the end.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ab</span><span class="se">\t</span><span class="s1">cd</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;ab</span><span class="se">\t</span><span class="s1">cd</span><span class="se">\t</span><span class="s1">ef&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tab_reader</span> <span class="o">=</span> <span class="n">SeparatorFormatParser</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tab_reader</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="n">line</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-a-custom-reader-that-operates-on-entire-lines">
<h3>Defining a custom reader that operates on entire lines<a class="headerlink" href="#defining-a-custom-reader-that-operates-on-entire-lines" title="Permalink to this headline">¶</a></h3>
<p>It can also be the case that data types differ between lines. The basic mechanism is the same as above, except in defining the converter you must set the argument <code class="docutils literal notranslate"><span class="pre">by_column=True</span></code>.</p>
<p>We illustrate this capability by writing a short function that tries to cast entire lines to <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code> or leaves as a string.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">CastLine</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">floats</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">ints</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">line</span> <span class="o">=</span> <span class="n">ints</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>                <span class="n">line</span> <span class="o">=</span> <span class="n">floats</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="gp">... </span>            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<span class="gp">... </span>                <span class="k">pass</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">line</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">call</span>
</pre></div>
</div>
<p>We then define a couple of lines, create an instance of <code class="docutils literal notranslate"><span class="pre">ConvertFields</span></code> and call it for each type.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">line_str_ints</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_str_floats</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">line_str_ints</span><span class="p">,</span> <span class="n">line_str_floats</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">ConvertFields</span><span class="p">(</span><span class="n">CastLine</span><span class="p">(),</span> <span class="n">by_column</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tab_reader</span> <span class="o">=</span> <span class="n">SeparatorFormatParser</span><span class="p">(</span><span class="n">with_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">converter</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<span class="gp">... </span>                                   <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tab_reader</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4]</span>
<span class="go">[0.0, 1.0, 2.0, 3.0, 4.0]</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-a-custom-writer">
<h3>Defining a custom writer<a class="headerlink" href="#defining-a-custom-writer" title="Permalink to this headline">¶</a></h3>
<p>We can likewise specify a writer, using a custom field formatter and provide this to the <code class="docutils literal notranslate"><span class="pre">Table</span></code> directly for writing. We first illustrate how the writer works to generate output. We then use it to escape some text fields in quotes. In order to read that back in, we define a custom reader that strips these quotes off.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent3.format.table</span> <span class="kn">import</span> <span class="n">format_fields</span><span class="p">,</span> <span class="n">separator_formatter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formatter</span> <span class="o">=</span> <span class="n">format_fields</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span> <span class="o">=</span> <span class="n">separator_formatter</span><span class="p">(</span><span class="n">formatter</span><span class="o">=</span><span class="n">formatter</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; | &quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">formatted</span> <span class="ow">in</span> <span class="n">writer</span><span class="p">(</span><span class="n">comma_sep</span><span class="p">,</span> <span class="n">has_header</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="gp">... </span>     <span class="nb">print</span><span class="p">(</span><span class="n">formatted</span><span class="p">)</span>
<span class="go">edge.name | edge.parent | length | x | y | z</span>
<span class="go">&quot;Human&quot; | &quot;edge.0&quot; | 4.0 | 1.0 | 3.0 | 6.0</span>
<span class="go">&quot;HowlerMon&quot; | &quot;edge.0&quot; | 4.0 | 1.0 | 3.0 | 6.0</span>
<span class="go">&quot;Mouse&quot; | &quot;edge.1&quot; | 4.0 | 1.0 | 3.0 | 6.0</span>
<span class="go">&quot;NineBande&quot; | &quot;root&quot; | 4.0 | 1.0 | 3.0 | 6.0</span>
<span class="go">&quot;DogFaced&quot; | &quot;root&quot; | 4.0 | 1.0 | 3.0 | 6.0</span>
<span class="go">&quot;edge.0&quot; | &quot;edge.1&quot; | 4.0 | 1.0 | 3.0 | 6.0</span>
<span class="go">&quot;edge.1&quot; | &quot;root&quot; | 4.0 | 1.0 | 3.0 | 6.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;t3.tab&quot;</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">writer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strip</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">converter</span> <span class="o">=</span> <span class="n">ConvertFields</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="n">strip</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">strip</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">SeparatorFormatParser</span><span class="p">(</span><span class="n">with_header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">converter</span><span class="o">=</span><span class="n">converter</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="n">strip_wspace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3a</span> <span class="o">=</span> <span class="n">load_table</span><span class="p">(</span><span class="s2">&quot;t3.tab&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="n">reader</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;new title&quot;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">space</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3a</span><span class="p">)</span>
<span class="go">new title</span>
<span class="go">=============================================</span>
<span class="go">edge.name  edge.parent  length    x    y    z</span>
<span class="go">---------------------------------------------</span>
<span class="go">    Human       edge.0     4.0  1.0  3.0  6.0</span>
<span class="go">HowlerMon       edge.0     4.0  1.0  3.0  6.0</span>
<span class="go">    Mouse       edge.1     4.0  1.0  3.0  6.0</span>
<span class="go">NineBande         root     4.0  1.0  3.0  6.0</span>
<span class="go"> DogFaced         root     4.0  1.0  3.0  6.0</span>
<span class="go">   edge.0       edge.1     4.0  1.0  3.0  6.0</span>
<span class="go">   edge.1         root     4.0  1.0  3.0  6.0</span>
<span class="go">---------------------------------------------</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are performance issues for large files. Pickling has proven very slow for saving very large files and introduces significant file size bloat. A simple delimited format is much more efficient both storage wise and, if you use a custom reader (or specify <code class="docutils literal notranslate"><span class="pre">static_column_types=True</span></code>), to generate and read. A custom reader was approximately 6 fold faster than the standard delimited file reader.</p>
</div>
</div>
</div>
<div class="section" id="table-slicing-and-iteration">
<h2>Table slicing and iteration<a class="headerlink" href="#table-slicing-and-iteration" title="Permalink to this headline">¶</a></h2>
<p>The Table class is capable of slicing by row, range of rows, column or range of columns headings or used to identify a single cell. Slicing using the method <code class="docutils literal notranslate"><span class="pre">get_columns</span></code> can also be used to reorder columns. In the case of columns, either the string headings or their position integers can be used. For rows, if <code class="docutils literal notranslate"><span class="pre">row_ids</span></code> was specified, the cell values in that column can also be used.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;edge.name&#39;</span><span class="p">,</span> <span class="s1">&#39;edge.parent&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">d2D</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">row_order</span><span class="o">=</span><span class="n">row_order</span><span class="p">,</span> <span class="n">row_ids</span><span class="o">=</span><span class="s1">&#39;edge.name&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;My title&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We subset <code class="docutils literal notranslate"><span class="pre">t4</span></code> by column and reorder them.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="n">t4</span><span class="o">.</span><span class="n">get_columns</span><span class="p">([</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">=============================</span>
<span class="go">edge.name         z         y</span>
<span class="go">-----------------------------</span>
<span class="go">    Human    6.0000    3.0000</span>
<span class="go">HowlerMon    6.0000    3.0000</span>
<span class="go">    Mouse    6.0000    3.0000</span>
<span class="go">NineBande    6.0000    3.0000</span>
<span class="go"> DogFaced    6.0000    3.0000</span>
<span class="go">   edge.0    6.0000    3.0000</span>
<span class="go">   edge.1    6.0000    3.0000</span>
<span class="go">-----------------------------</span>
</pre></div>
</div>
<p>We use the column position indexes to do get the same table.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="n">t4</span><span class="o">.</span><span class="n">get_columns</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">=============================</span>
<span class="go">edge.name         z         y</span>
<span class="go">-----------------------------</span>
<span class="go">    Human    6.0000    3.0000</span>
<span class="go">HowlerMon    6.0000    3.0000</span>
<span class="go">    Mouse    6.0000    3.0000</span>
<span class="go">NineBande    6.0000    3.0000</span>
<span class="go"> DogFaced    6.0000    3.0000</span>
<span class="go">   edge.0    6.0000    3.0000</span>
<span class="go">   edge.1    6.0000    3.0000</span>
<span class="go">-----------------------------</span>
</pre></div>
</div>
<p>We can also using more general slicing, by both rows and columns. The following returns all rows from 4 on, and columns up to (but excluding) ‘y’:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">t4</span><span class="p">[</span><span class="mi">4</span><span class="p">:,</span> <span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">============================================</span>
<span class="go">edge.name    edge.parent    length         x</span>
<span class="go">--------------------------------------------</span>
<span class="go"> DogFaced           root    4.0000    1.0000</span>
<span class="go">   edge.0         edge.1    4.0000    1.0000</span>
<span class="go">   edge.1           root    4.0000    1.0000</span>
<span class="go">--------------------------------------------</span>
</pre></div>
</div>
<p>We can explicitly reference individual cells, in this case using both row and column keys.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">t4</span><span class="p">[</span><span class="s1">&#39;HowlerMon&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="go">3.0</span>
</pre></div>
</div>
<p>We slice a single row,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="n">t4</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">================================================================</span>
<span class="go">edge.name    edge.parent    length         x         y         z</span>
<span class="go">----------------------------------------------------------------</span>
<span class="go">NineBande           root    4.0000    1.0000    3.0000    6.0000</span>
<span class="go">----------------------------------------------------------------</span>
</pre></div>
</div>
<p>and range of rows.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="n">t4</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">================================================================</span>
<span class="go">edge.name    edge.parent    length         x         y         z</span>
<span class="go">----------------------------------------------------------------</span>
<span class="go">NineBande           root    4.0000    1.0000    3.0000    6.0000</span>
<span class="go"> DogFaced           root    4.0000    1.0000    3.0000    6.0000</span>
<span class="go">   edge.0         edge.1    4.0000    1.0000    3.0000    6.0000</span>
<span class="go">----------------------------------------------------------------</span>
</pre></div>
</div>
<p>You can iterate over the table one row at a time and slice the rows. We illustrate this for slicing a single column,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;stableid&#39;</span><span class="p">])</span>
<span class="go">ENSG00000005893</span>
<span class="go">ENSG00000019485</span>
<span class="go">ENSG00000019102...</span>
</pre></div>
</div>
<p>and for multiple columns.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;stableid&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">])</span>
<span class="go">ENSG00000005893 1353</span>
<span class="go">ENSG00000019485 1827</span>
<span class="go">ENSG00000019102 999...</span>
</pre></div>
</div>
<p>The numerical slice equivalent to the first case above would be <code class="docutils literal notranslate"><span class="pre">row[0]</span></code>, to the second case either <code class="docutils literal notranslate"><span class="pre">row[:]</span></code>, <code class="docutils literal notranslate"><span class="pre">row[:2]</span></code>.</p>
</div>
<div class="section" id="filtering-tables-selecting-subsets-of-rows-columns">
<h2>Filtering tables - selecting subsets of rows/columns<a class="headerlink" href="#filtering-tables-selecting-subsets-of-rows-columns" title="Permalink to this headline">¶</a></h2>
<p>We want to be able to slice a table, based on some condition(s), to produce a new subset table. For instance, we construct a table with type and probability values.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gene&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s1">&#39;Prob&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rows</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;NP_003077_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">2.5386</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1111</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_004893_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">0.1214</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.7276</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_005079_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">0.9517</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.3293</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_005500_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">0.7383</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.3902</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_055852_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.9997</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_057012_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Unco&#39;</span><span class="p">,</span> <span class="mf">34.3081</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_061130_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Unco&#39;</span><span class="p">,</span> <span class="mf">3.7986</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.0513</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_065168_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">89.9766</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_065396_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Unco&#39;</span><span class="p">,</span> <span class="mf">11.8912</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.0006</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_109590_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Con&#39;</span><span class="p">,</span> <span class="mf">0.2121</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.6451</span><span class="p">),</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;NP_116116_hs_mm_rn_dna&#39;</span><span class="p">,</span> <span class="s1">&#39;Unco&#39;</span><span class="p">,</span> <span class="mf">9.7474</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.0018</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t5</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t5</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con     2.5386     1    0.1111</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con     0.1214     1    0.7276</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con     0.9517     1    0.3293</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con     0.7383     1    0.3902</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con     0.0000     1    0.9997</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_061130_hs_mm_rn_dna    Unco     3.7986     1    0.0513</span>
<span class="go">NP_065168_hs_mm_rn_dna     Con    89.9766     1    0.0000</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_109590_hs_mm_rn_dna     Con     0.2121     1    0.6451</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>We then seek to obtain only those rows that contain probabilities &lt; 0.05. We use valid python code within a string. <strong>Note:</strong> Make sure your column headings could be valid python variable names or the string based approach will fail (you could use an external function instead, see below).</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_table1</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">filtered</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="s2">&quot;Prob &lt; 0.05&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sub_table1</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_065168_hs_mm_rn_dna     Con    89.9766     1    0.0000</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>Using the above table we test the function to extract the raw data for a single column,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span> <span class="o">=</span> <span class="n">sub_table1</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span>
<span class="go">[34.3081..., 89.9766..., 11.8912, 9.7474...]</span>
</pre></div>
</div>
<p>and from multiple columns.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span> <span class="o">=</span> <span class="n">sub_table1</span><span class="o">.</span><span class="n">tolist</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s1">&#39;Prob&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span>
<span class="go">[[1, 0.0], [1, 0.0],...</span>
</pre></div>
</div>
<p>We can also do filtering using an external function, in this case we use a <code class="docutils literal notranslate"><span class="pre">lambda</span></code> to obtain only those rows of type ‘Unco’ that contain probabilities &lt; 0.05, modifying our callback function.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_table2</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">filtered</span><span class="p">(</span>
<span class="gp">... </span>                <span class="k">lambda</span> <span class="n">ty_pr</span><span class="p">:</span> <span class="n">ty_pr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Unco&#39;</span> <span class="ow">and</span> <span class="n">ty_pr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;Prob&#39;</span><span class="p">)</span>
<span class="gp">... </span>                <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sub_table2</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>This can also be done using the string approach.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_table2</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">filtered</span><span class="p">(</span><span class="s2">&quot;type == &#39;Unco&#39; and Prob &lt; 0.05&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sub_table2</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>We can also filter table columns using <code class="docutils literal notranslate"><span class="pre">filtered_by_column</span></code>. Say we only want the numerical columns, we can write a callback that returns <code class="docutils literal notranslate"><span class="pre">False</span></code> if some numerical operation fails, <code class="docutils literal notranslate"><span class="pre">True</span></code> otherwise.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">is_numeric</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="kc">False</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t5</span><span class="o">.</span><span class="n">filtered_by_column</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">is_numeric</span><span class="p">))</span>
<span class="go">=======================</span>
<span class="go">     LR    df      Prob</span>
<span class="go">-----------------------</span>
<span class="go"> 2.5386     1    0.1111</span>
<span class="go"> 0.1214     1    0.7276</span>
<span class="go"> 0.9517     1    0.3293</span>
<span class="go"> 0.7383     1    0.3902</span>
<span class="go"> 0.0000     1    0.9997</span>
<span class="go">34.3081     1    0.0000</span>
<span class="go"> 3.7986     1    0.0513</span>
<span class="go">89.9766     1    0.0000</span>
<span class="go">11.8912     1    0.0006</span>
<span class="go"> 0.2121     1    0.6451</span>
<span class="go"> 9.7474     1    0.0018</span>
<span class="go">-----------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="appending-tables">
<h2>Appending tables<a class="headerlink" href="#appending-tables" title="Permalink to this headline">¶</a></h2>
<p>Tables may also be appended to each other, to make larger tables. We’ll construct two simple tables to illustrate this.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geneA</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;edge.name&#39;</span><span class="p">,</span> <span class="s1">&#39;edge.parent&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s1">&#39;Human&#39;</span><span class="p">,</span><span class="s1">&#39;root&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="mf">6.0</span><span class="p">],[</span><span class="s1">&#39;Mouse&#39;</span><span class="p">,</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Rat&#39;</span><span class="p">,</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]],</span>
<span class="gp">... </span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Gene A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geneB</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="s1">&#39;edge.name&#39;</span><span class="p">,</span> <span class="s1">&#39;edge.parent&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="p">[[</span><span class="s1">&#39;Human&#39;</span><span class="p">,</span><span class="s1">&#39;root&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="mf">7.0</span><span class="p">],[</span><span class="s1">&#39;Mouse&#39;</span><span class="p">,</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Rat&#39;</span><span class="p">,</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">]],</span>
<span class="gp">... </span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Gene B&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">geneB</span><span class="p">)</span>
<span class="go">Gene B</span>
<span class="go">==================================</span>
<span class="go">edge.name    edge.parent         z</span>
<span class="go">----------------------------------</span>
<span class="go">    Human           root    7.0000</span>
<span class="go">    Mouse           root    7.0000</span>
<span class="go">      Rat           root    7.0000</span>
<span class="go">----------------------------------</span>
</pre></div>
</div>
<p>we now use the <code class="docutils literal notranslate"><span class="pre">appended</span></code> Table method to create a new table, specifying that we want a new column created (by passing the <code class="docutils literal notranslate"><span class="pre">new_column</span></code> argument a heading) in which the table titles will be placed.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="n">geneA</span><span class="o">.</span><span class="n">appended</span><span class="p">(</span><span class="s1">&#39;Gene&#39;</span><span class="p">,</span> <span class="n">geneB</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Appended tables&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="go">Appended tables</span>
<span class="go">============================================</span>
<span class="go">  Gene    edge.name    edge.parent         z</span>
<span class="go">--------------------------------------------</span>
<span class="go">Gene A        Human           root    6.0000</span>
<span class="go">Gene A        Mouse           root    6.0000</span>
<span class="go">Gene A          Rat           root    6.0000</span>
<span class="go">Gene B        Human           root    7.0000</span>
<span class="go">Gene B        Mouse           root    7.0000</span>
<span class="go">Gene B          Rat           root    7.0000</span>
<span class="go">--------------------------------------------</span>
</pre></div>
</div>
<p>We repeat this without adding a new column.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new</span> <span class="o">=</span> <span class="n">geneA</span><span class="o">.</span><span class="n">appended</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">geneB</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Appended, no new column&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
<span class="go">Appended, no new column</span>
<span class="go">==================================</span>
<span class="go">edge.name    edge.parent         z</span>
<span class="go">----------------------------------</span>
<span class="go">    Human           root    6.0000</span>
<span class="go">    Mouse           root    6.0000</span>
<span class="go">      Rat           root    6.0000</span>
<span class="go">    Human           root    7.0000</span>
<span class="go">    Mouse           root    7.0000</span>
<span class="go">      Rat           root    7.0000</span>
<span class="go">----------------------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<p>Tables have a <code class="docutils literal notranslate"><span class="pre">shape</span></code> attribute, which specifies <em>x</em> (number of columns) and <em>y</em> (number of rows). The attribute is a tuple and we illustrate it for the above <code class="docutils literal notranslate"><span class="pre">sub_table</span></code> tables. Combined with the <code class="docutils literal notranslate"><span class="pre">filtered</span></code> method, this attribute can tell you how many rows satisfy a specific condition.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t5</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(11, 5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_table1</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_table2</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 5)</span>
</pre></div>
</div>
<p>For instance, 3 of the 11 rows in <code class="docutils literal notranslate"><span class="pre">t</span></code> were significant and belonged to the <code class="docutils literal notranslate"><span class="pre">Unco</span></code> type.</p>
<p>For completeness, we generate a table with no rows and assess its shape.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_table3</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">filtered</span><span class="p">(</span>
<span class="gp">... </span>               <span class="k">lambda</span> <span class="n">ty_pr</span><span class="p">:</span> <span class="n">ty_pr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Unco&#39;</span> <span class="ow">and</span> <span class="n">ty_pr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;Prob&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_table3</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(0, 5)</span>
</pre></div>
</div>
<p>The distinct values can be obtained for a single column,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distinct</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">distinct_values</span><span class="p">(</span><span class="s2">&quot;edge.name&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">distinct</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;Rat&#39;</span><span class="p">,</span> <span class="s1">&#39;Mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;Human&#39;</span><span class="p">]),</span> <span class="n">distinct</span>
</pre></div>
</div>
<p>or multiple columns</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distinct</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">distinct_values</span><span class="p">([</span><span class="s2">&quot;edge.parent&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">distinct</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([(</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">)]),</span> <span class="n">distinct</span>
</pre></div>
</div>
<p>We can compute column sums. Assuming only numerical values in a column.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">new</span><span class="o">.</span><span class="n">summed</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mf">39.</span><span class="p">,</span> <span class="n">new</span><span class="o">.</span><span class="n">summed</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We construct an example with mixed numerical and non-numerical data. We now compute the column sum with mixed non-numerical/numerical data.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mix</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mix</span><span class="p">)</span>
<span class="go">======</span>
<span class="go">A    B</span>
<span class="go">------</span>
<span class="go">0</span>
<span class="go">1    2</span>
<span class="go">3    4</span>
<span class="go">------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mix</span><span class="o">.</span><span class="n">summed</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
<p>We also compute row sums for the pure numerical and mixed non-numerical/numerical rows. For summing across rows we must specify the actual row index as an <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mix</span><span class="o">.</span><span class="n">summed</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mix</span><span class="o">.</span><span class="n">summed</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>We can compute the totals for all columns or rows too.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mix</span><span class="o">.</span><span class="n">summed</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[4, 6]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mix</span><span class="o">.</span><span class="n">summed</span><span class="p">(</span><span class="n">col_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[0, 3, 7]</span>
</pre></div>
</div>
<p>We test these for a strictly numerical table.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">non_mix</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">non_mix</span><span class="o">.</span><span class="n">summed</span><span class="p">()</span>
<span class="go">[4, 7]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">non_mix</span><span class="o">.</span><span class="n">summed</span><span class="p">(</span><span class="n">col_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[1, 3, 7]</span>
</pre></div>
</div>
<p>We can normalise a numerical table by row,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">non_mix</span><span class="o">.</span><span class="n">normalized</span><span class="p">(</span><span class="n">by_row</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">================</span>
<span class="go">     A         B</span>
<span class="go">----------------</span>
<span class="go">0.0000    1.0000</span>
<span class="go">0.3333    0.6667</span>
<span class="go">0.4286    0.5714</span>
<span class="go">----------------</span>
</pre></div>
</div>
<p>or by column, such that the row/column sums are 1.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">non_mix</span><span class="o">.</span><span class="n">normalized</span><span class="p">(</span><span class="n">by_row</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">================</span>
<span class="go">     A         B</span>
<span class="go">----------------</span>
<span class="go">0.0000    0.1429</span>
<span class="go">0.2500    0.2857</span>
<span class="go">0.7500    0.5714</span>
<span class="go">----------------</span>
</pre></div>
</div>
<p>We normalize by an arbitrary function (maximum value) by row,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">non_mix</span><span class="o">.</span><span class="n">normalized</span><span class="p">(</span><span class="n">by_row</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">denominator_func</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
<span class="go">================</span>
<span class="go">     A         B</span>
<span class="go">----------------</span>
<span class="go">0.0000    1.0000</span>
<span class="go">0.5000    1.0000</span>
<span class="go">0.7500    1.0000</span>
<span class="go">----------------</span>
</pre></div>
</div>
<p>by column.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">non_mix</span><span class="o">.</span><span class="n">normalized</span><span class="p">(</span><span class="n">by_row</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">denominator_func</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
<span class="go">================</span>
<span class="go">     A         B</span>
<span class="go">----------------</span>
<span class="go">0.0000    0.2500</span>
<span class="go">0.3333    0.5000</span>
<span class="go">1.0000    1.0000</span>
<span class="go">----------------</span>
</pre></div>
</div>
</div>
<div class="section" id="extending-tables">
<h2>Extending tables<a class="headerlink" href="#extending-tables" title="Permalink to this headline">¶</a></h2>
<p>In some cases it is desirable to compute an additional column from existing column values. This is done using the <code class="docutils literal notranslate"><span class="pre">with_new_column</span></code> method. We’ll use t4 from above, adding two of the columns to create an additional column.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t7</span> <span class="o">=</span> <span class="n">t4</span><span class="o">.</span><span class="n">with_new_column</span><span class="p">(</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="s2">&quot;z+x&quot;</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t7</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">==================================================================</span>
<span class="go">edge.name    edge.parent    length       x       y       z     Sum</span>
<span class="go">------------------------------------------------------------------</span>
<span class="go">    Human         edge.0      4.00    1.00    3.00    6.00    7.00</span>
<span class="go">HowlerMon         edge.0      4.00    1.00    3.00    6.00    7.00</span>
<span class="go">    Mouse         edge.1      4.00    1.00    3.00    6.00    7.00</span>
<span class="go">NineBande           root      4.00    1.00    3.00    6.00    7.00</span>
<span class="go"> DogFaced           root      4.00    1.00    3.00    6.00    7.00</span>
<span class="go">   edge.0         edge.1      4.00    1.00    3.00    6.00    7.00</span>
<span class="go">   edge.1           root      4.00    1.00    3.00    6.00    7.00</span>
<span class="go">------------------------------------------------------------------</span>
</pre></div>
</div>
<p>We test this with an externally defined function.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x_y</span><span class="p">:</span> <span class="n">x_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t7</span> <span class="o">=</span> <span class="n">t4</span><span class="o">.</span><span class="n">with_new_column</span><span class="p">(</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="s2">&quot;z&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="n">digits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t7</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">===================================================================</span>
<span class="go">edge.name    edge.parent    length       x       y       z      Sum</span>
<span class="go">-------------------------------------------------------------------</span>
<span class="go">    Human         edge.0      4.00    1.00    3.00    6.00    18.00</span>
<span class="go">HowlerMon         edge.0      4.00    1.00    3.00    6.00    18.00</span>
<span class="go">    Mouse         edge.1      4.00    1.00    3.00    6.00    18.00</span>
<span class="go">NineBande           root      4.00    1.00    3.00    6.00    18.00</span>
<span class="go"> DogFaced           root      4.00    1.00    3.00    6.00    18.00</span>
<span class="go">   edge.0         edge.1      4.00    1.00    3.00    6.00    18.00</span>
<span class="go">   edge.1           root      4.00    1.00    3.00    6.00    18.00</span>
<span class="go">-------------------------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t7</span> <span class="o">=</span> <span class="n">t4</span><span class="o">.</span><span class="n">with_new_column</span><span class="p">(</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t7</span><span class="p">)</span>
<span class="go">My title</span>
<span class="go">===================================================================</span>
<span class="go">edge.name    edge.parent    length       x       y       z      Sum</span>
<span class="go">-------------------------------------------------------------------</span>
<span class="go">    Human         edge.0      4.00    1.00    3.00    6.00    27.00</span>
<span class="go">HowlerMon         edge.0      4.00    1.00    3.00    6.00    27.00</span>
<span class="go">    Mouse         edge.1      4.00    1.00    3.00    6.00    27.00</span>
<span class="go">NineBande           root      4.00    1.00    3.00    6.00    27.00</span>
<span class="go"> DogFaced           root      4.00    1.00    3.00    6.00    27.00</span>
<span class="go">   edge.0         edge.1      4.00    1.00    3.00    6.00    27.00</span>
<span class="go">   edge.1           root      4.00    1.00    3.00    6.00    27.00</span>
<span class="go">-------------------------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="sorting-tables">
<h2>Sorting tables<a class="headerlink" href="#sorting-tables" title="Permalink to this headline">¶</a></h2>
<p>We want a table sorted according to values in a column.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con     0.0000     1    0.9997</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con     0.1214     1    0.7276</span>
<span class="go">NP_109590_hs_mm_rn_dna     Con     0.2121     1    0.6451</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con     0.7383     1    0.3902</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con     0.9517     1    0.3293</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con     2.5386     1    0.1111</span>
<span class="go">NP_061130_hs_mm_rn_dna    Unco     3.7986     1    0.0513</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_065168_hs_mm_rn_dna     Con    89.9766     1    0.0000</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>We want a table sorted according to values in a subset of columns, note the order of columns determines the sort order.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con     0.0000     1    0.9997</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con     0.1214     1    0.7276</span>
<span class="go">NP_109590_hs_mm_rn_dna     Con     0.2121     1    0.6451</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con     0.7383     1    0.3902</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con     0.9517     1    0.3293</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con     2.5386     1    0.1111</span>
<span class="go">NP_061130_hs_mm_rn_dna    Unco     3.7986     1    0.0513</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_065168_hs_mm_rn_dna     Con    89.9766     1    0.0000</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>We now do a sort based on 2 columns.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con     0.0000     1    0.9997</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con     0.1214     1    0.7276</span>
<span class="go">NP_109590_hs_mm_rn_dna     Con     0.2121     1    0.6451</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con     0.7383     1    0.3902</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con     0.9517     1    0.3293</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con     2.5386     1    0.1111</span>
<span class="go">NP_065168_hs_mm_rn_dna     Con    89.9766     1    0.0000</span>
<span class="go">NP_061130_hs_mm_rn_dna    Unco     3.7986     1    0.0513</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>Reverse sort a single column</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="s1">&#39;LR&#39;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_065168_hs_mm_rn_dna     Con    89.9766     1    0.0000</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">NP_061130_hs_mm_rn_dna    Unco     3.7986     1    0.0513</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con     2.5386     1    0.1111</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con     0.9517     1    0.3293</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con     0.7383     1    0.3902</span>
<span class="go">NP_109590_hs_mm_rn_dna     Con     0.2121     1    0.6451</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con     0.1214     1    0.7276</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con     0.0000     1    0.9997</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>Sort by just specifying the <code class="docutils literal notranslate"><span class="pre">reverse</span></code> column</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_065168_hs_mm_rn_dna     Con    89.9766     1    0.0000</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">NP_061130_hs_mm_rn_dna    Unco     3.7986     1    0.0513</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con     2.5386     1    0.1111</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con     0.9517     1    0.3293</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con     0.7383     1    0.3902</span>
<span class="go">NP_109590_hs_mm_rn_dna     Con     0.2121     1    0.6451</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con     0.1214     1    0.7276</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con     0.0000     1    0.9997</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>Reverse sort one column but not another</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_065168_hs_mm_rn_dna     Con    89.9766     1    0.0000</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con     2.5386     1    0.1111</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con     0.9517     1    0.3293</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con     0.7383     1    0.3902</span>
<span class="go">NP_109590_hs_mm_rn_dna     Con     0.2121     1    0.6451</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con     0.1214     1    0.7276</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con     0.0000     1    0.9997</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">NP_061130_hs_mm_rn_dna    Unco     3.7986     1    0.0513</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
<p>Reverse sort both columns.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span> <span class="o">=</span> <span class="n">t5</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">)</span>
<span class="go">=========================================================</span>
<span class="go">                  Gene    type         LR    df      Prob</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NP_057012_hs_mm_rn_dna    Unco    34.3081     1    0.0000</span>
<span class="go">NP_065396_hs_mm_rn_dna    Unco    11.8912     1    0.0006</span>
<span class="go">NP_116116_hs_mm_rn_dna    Unco     9.7474     1    0.0018</span>
<span class="go">NP_061130_hs_mm_rn_dna    Unco     3.7986     1    0.0513</span>
<span class="go">NP_065168_hs_mm_rn_dna     Con    89.9766     1    0.0000</span>
<span class="go">NP_003077_hs_mm_rn_dna     Con     2.5386     1    0.1111</span>
<span class="go">NP_005079_hs_mm_rn_dna     Con     0.9517     1    0.3293</span>
<span class="go">NP_005500_hs_mm_rn_dna     Con     0.7383     1    0.3902</span>
<span class="go">NP_109590_hs_mm_rn_dna     Con     0.2121     1    0.6451</span>
<span class="go">NP_004893_hs_mm_rn_dna     Con     0.1214     1    0.7276</span>
<span class="go">NP_055852_hs_mm_rn_dna     Con     0.0000     1    0.9997</span>
<span class="go">---------------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="joining-tables">
<h2>Joining Tables<a class="headerlink" href="#joining-tables" title="Permalink to this headline">¶</a></h2>
<p>The Table object is capable of joins or merging of records in two tables. There are two fundamental types of joins – inner and outer – with there being different sub-types. We demonstrate these first constructing some simple tables.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">,</span><span class="s2">&quot;col3&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">A</span>
<span class="go">=====================</span>
<span class="go">index    col2    col3</span>
<span class="go">---------------------</span>
<span class="go">    1       2       3</span>
<span class="go">    2       3       1</span>
<span class="go">    2       6       5</span>
<span class="go">---------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">=</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">,</span><span class="s2">&quot;col3&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">B</span>
<span class="go">=====================</span>
<span class="go">index    col2    col3</span>
<span class="go">---------------------</span>
<span class="go">    1       2       3</span>
<span class="go">    2       2       1</span>
<span class="go">    3       6       3</span>
<span class="go">---------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">=</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="s2">&quot;col_c2&quot;</span><span class="p">],</span><span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">C</span>
<span class="go">===============</span>
<span class="go">index    col_c2</span>
<span class="go">---------------</span>
<span class="go">    1         2</span>
<span class="go">    3         2</span>
<span class="go">    3         5</span>
<span class="go">---------------</span>
</pre></div>
</div>
<p>For a natural inner join, only 1 copy of columns with the same name are retained. So we expect the headings to be identical between the table <code class="docutils literal notranslate"><span class="pre">a</span></code>/<code class="docutils literal notranslate"><span class="pre">b</span></code> and the result of <code class="docutils literal notranslate"><span class="pre">a.joined(b)</span></code> or <code class="docutils literal notranslate"><span class="pre">b.joined(a)</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">header</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">b</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">header</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">header</span>
</pre></div>
</div>
<p>For a standard inner join, the joined table should contain all columns from <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> excepting the index column(s). Simply providing a column name (or index) selects this behaviour. Note that in this case, column names from the second table are made unique by prefixing them with that tables title. If the right table does not have a title, a default value <cite>right</cite> is used.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">===========================================</span>
<span class="go">index    col_c2    right_col2    right_col3</span>
<span class="go">-------------------------------------------</span>
<span class="go">    1         2             2             3</span>
<span class="go">    3         2             6             3</span>
<span class="go">    3         5             6             3</span>
<span class="go">-------------------------------------------</span>

<span class="go">3 rows x 4 columns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">header</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="s2">&quot;B_col2&quot;</span><span class="p">,</span> <span class="s2">&quot;B_col3&quot;</span><span class="p">)</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Note that the table title’s were used to prefix the column headings from the second table. We further test this using table <code class="docutils literal notranslate"><span class="pre">c</span></code> which has different dimensions.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">header</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="s2">&quot;col2&quot;</span><span class="p">,</span><span class="s2">&quot;col3&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="s2">&quot;C_col_c2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>It’s also possible to specify index columns using numerical values, the results of which should be the same.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r1</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">,[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="s2">&quot;col3&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">r1</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">==</span> <span class="n">r2</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
<p>Additionally, it’s possible to provide two series of indices for the two tables. Here, they have identical values.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">],[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>\
<span class="gp">... </span>        <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">,[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="s2">&quot;col3&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
<p>The results of a standard join between tables <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A&amp;B&#39;</span><span class="p">))</span>
<span class="go">A&amp;B</span>
<span class="go">=========================================</span>
<span class="go">index    col2    col3    B_col2    B_col3</span>
<span class="go">-----------------------------------------</span>
<span class="go">    1       2       3         2         3</span>
<span class="go">    2       3       1         2         1</span>
<span class="go">    2       6       5         2         1</span>
<span class="go">-----------------------------------------</span>
</pre></div>
</div>
<p>We demo the table specific indices.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;col2&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A&amp;C by &quot;col2/index&quot;&#39;</span><span class="p">))</span>
<span class="go">A&amp;C by &quot;col2/index&quot;</span>
<span class="go">=================================</span>
<span class="go">index    col2    col3    C_col_c2</span>
<span class="go">---------------------------------</span>
<span class="go">    2       3       1           2</span>
<span class="go">    2       3       1           5</span>
<span class="go">---------------------------------</span>
</pre></div>
</div>
<p>Tables <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code> share a single row with the same value in the <code class="docutils literal notranslate"><span class="pre">index</span></code> column, hence a join by that index should return a table with just that row.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A&amp;C by &quot;index&quot;&#39;</span><span class="p">))</span>
<span class="go">A&amp;C by &quot;index&quot;</span>
<span class="go">=================================</span>
<span class="go">index    col2    col3    C_col_c2</span>
<span class="go">---------------------------------</span>
<span class="go">    1       2       3           2</span>
<span class="go">---------------------------------</span>
</pre></div>
</div>
<p>A natural join of tables <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> results in a table with only rows that were identical between the two parents.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A&amp;B Natural Join&#39;</span><span class="p">))</span>
<span class="go">A&amp;B Natural Join</span>
<span class="go">=====================</span>
<span class="go">index    col2    col3</span>
<span class="go">---------------------</span>
<span class="go">    1       2       3</span>
<span class="go">---------------------</span>
</pre></div>
</div>
<p>We test the outer join by defining an additional table with different dimensions, and conducting a join specifying <code class="docutils literal notranslate"><span class="pre">inner_join=False</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">=</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col_c2&quot;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">42</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">23</span><span class="p">]],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">D</span>
<span class="go">===============</span>
<span class="go">index    col_c2</span>
<span class="go">---------------</span>
<span class="go">    5        42</span>
<span class="go">    6        23</span>
<span class="go">---------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">inner_join</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;C&amp;D Outer join&#39;</span><span class="p">))</span>
<span class="go">C&amp;D Outer join</span>
<span class="go">======================================</span>
<span class="go">index    col_c2    D_index    D_col_c2</span>
<span class="go">--------------------------------------</span>
<span class="go">    1         2          5          42</span>
<span class="go">    1         2          6          23</span>
<span class="go">    3         2          5          42</span>
<span class="go">    3         2          6          23</span>
<span class="go">    3         5          5          42</span>
<span class="go">    3         5          6          23</span>
<span class="go">--------------------------------------</span>
</pre></div>
</div>
<p>We establish the <code class="docutils literal notranslate"><span class="pre">joined</span></code> method works for mixtures of character and numerical data, setting some indices and some cell values to be strings.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">=</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">,</span><span class="s2">&quot;col3&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">],[</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">=</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">,</span><span class="s2">&quot;col3&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">],[</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">],[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>\
<span class="gp">... </span>        <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">b</span><span class="p">,[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="s2">&quot;col3&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
<p>We test that the <code class="docutils literal notranslate"><span class="pre">joined</span></code> method works when the column index orders differ.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t1_header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1_rows</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2_header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2_rows</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">t1_header</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">t1_rows</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">t2_header</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">t2_rows</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;t2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">columns_self</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="n">columns_other</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span>
<span class="go">==============</span>
<span class="go">a    b    t2_c</span>
<span class="go">--------------</span>
<span class="go">3    4       8</span>
<span class="go">--------------</span>
</pre></div>
</div>
<p>We then establish that a join with no values does not cause a failure, just returns an empty <code class="docutils literal notranslate"><span class="pre">Table</span></code>.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t4_header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t4_rows</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">t4_header</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">t4_rows</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;t4&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t5</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span> <span class="n">columns_self</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="n">columns_other</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t5</span><span class="p">)</span>
<span class="go">==============</span>
<span class="go">a    b    t4_c</span>
<span class="go">--------------</span>
<span class="go">--------------</span>
</pre></div>
</div>
<p>Whose representation looks like</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t5</span>
<span class="go">==============</span>
<span class="go">a    b    t4_c</span>
<span class="go">--------------</span>
<span class="go">--------------</span>

<span class="go">0 rows x 3 columns</span>
</pre></div>
</div>
</div>
<div class="section" id="transposing-a-table">
<h2>Transposing a table<a class="headerlink" href="#transposing-a-table" title="Permalink to this headline">¶</a></h2>
<p>Tables can be transposed.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent3</span> <span class="kn">import</span> <span class="n">make_table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;#Full OTU Counts&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#OTU ID&#39;</span><span class="p">,</span> <span class="s1">&#39;14SK041&#39;</span><span class="p">,</span> <span class="s1">&#39;14SK802&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">2920</span><span class="p">,</span> <span class="s1">&#39;332&#39;</span><span class="p">,</span> <span class="mi">294</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="o">-</span><span class="mi">1606</span><span class="p">,</span> <span class="s1">&#39;302&#39;</span><span class="p">,</span> <span class="mi">229</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="o">-</span><span class="mi">393</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">125</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="o">-</span><span class="mi">2109</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="o">-</span><span class="mi">5439</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">117</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="o">-</span><span class="mi">1834</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="o">-</span><span class="mi">18588</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">47</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="o">-</span><span class="mi">1350</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">113</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="o">-</span><span class="mi">2160</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">52</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="o">-</span><span class="mi">11632</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">36</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">make_table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="go">#Full OTU Counts</span>
<span class="go">=============================</span>
<span class="go">#OTU ID    14SK041    14SK802</span>
<span class="go">-----------------------------</span>
<span class="go">  -2920        332        294</span>
<span class="go">  -1606        302        229</span>
<span class="go">   -393        141        125</span>
<span class="go">  -2109        138        120</span>
<span class="go">  -5439        104        117</span>
<span class="go">  -1834         70         75</span>
<span class="go"> -18588         65         47</span>
<span class="go">  -1350         60        113</span>
<span class="go">  -2160         57         52</span>
<span class="go"> -11632         47         36</span>
<span class="go">-----------------------------</span>
</pre></div>
</div>
<p>We now transpose this. We require a new column heading for header data and an identifier for which existing column will become the header (default is index 0).</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tp</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">transposed</span><span class="p">(</span><span class="n">new_column_name</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">select_as_header</span><span class="o">=</span><span class="s1">&#39;#OTU ID&#39;</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
<span class="go">#Full OTU Counts</span>
<span class="go">==============================================================================</span>
<span class="go"> sample  -2920  -1606  -393  -2109  -5439  -1834  -18588  -1350  -2160  -11632</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">14SK041    332    302   141    138    104     70      65     60     57      47</span>
<span class="go">14SK802    294    229   125    120    117     75      47    113     52      36</span>
<span class="go">------------------------------------------------------------------------------</span>
</pre></div>
</div>
<p>We test transposition with default value is the same.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tp</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">transposed</span><span class="p">(</span><span class="n">new_column_name</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
<span class="go">#Full OTU Counts</span>
<span class="go">==============================================================================</span>
<span class="go"> sample  -2920  -1606  -393  -2109  -5439  -1834  -18588  -1350  -2160  -11632</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">14SK041    332    302   141    138    104     70      65     60     57      47</span>
<span class="go">14SK802    294    229   125    120    117     75      47    113     52      36</span>
<span class="go">------------------------------------------------------------------------------</span>
</pre></div>
</div>
<p>We test transposition selecting a different column to become the header.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tp</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">transposed</span><span class="p">(</span><span class="n">new_column_name</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">select_as_header</span><span class="o">=</span><span class="s1">&#39;14SK802&#39;</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
<span class="go">#Full OTU Counts</span>
<span class="go">==============================================================================</span>
<span class="go"> sample    294    229   125    120    117     75      47    113     52      36</span>
<span class="go">------------------------------------------------------------------------------</span>
<span class="go">#OTU ID  -2920  -1606  -393  -2109  -5439  -1834  -18588  -1350  -2160  -11632</span>
<span class="go">14SK041    332    302   141    138    104     70      65     60     57      47</span>
<span class="go">------------------------------------------------------------------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="counting-rows">
<h2>Counting rows<a class="headerlink" href="#counting-rows" title="Permalink to this headline">¶</a></h2>
<p>We can count the number of rows for which a condition holds. This method uses the same arguments as <code class="docutils literal notranslate"><span class="pre">filtered</span></code> but returns an integer result only.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;col_c2 == 2&quot;</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">joined</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">inner_join</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;index==3 and D_index==5&quot;</span><span class="p">))</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<div class="section" id="testing-a-sub-component">
<h2>Testing a sub-component<a class="headerlink" href="#testing-a-sub-component" title="Permalink to this headline">¶</a></h2>
<p>Before using <code class="docutils literal notranslate"><span class="pre">Table</span></code>, we exercise some formatting code:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent3.format.table</span> <span class="kn">import</span> <span class="n">formatted_cells</span><span class="p">,</span> <span class="n">phylip_matrix</span><span class="p">,</span> <span class="n">latex</span>
</pre></div>
</div>
<p>We check we can format an arbitrary 2D list, without a header, using the <code class="docutils literal notranslate"><span class="pre">formatted_cells</span></code> function directly.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">230</span><span class="p">,</span> <span class="s1">&#39;acdef&#39;</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span> <span class="mf">1.9876</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">head</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span><span class="p">,</span> <span class="n">formatted</span> <span class="o">=</span> <span class="n">formatted_cells</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">head</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">formatted</span><span class="p">)</span>
<span class="go">[[&#39;230&#39;, &#39;acdef&#39;, &#39;1.3000&#39;], [&#39;  6&#39;, &#39;   cc&#39;, &#39;1.9876&#39;]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
<span class="go">[&#39;one&#39;, &#39;  two&#39;, &#39; three&#39;]</span>
</pre></div>
</div>
<p>We directly test the latex formatting.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">formatted</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;lrl&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s1">&#39;A legend&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;table:test&quot;</span><span class="p">))</span>
<span class="go">\begin{table}[htp!]</span>
<span class="go">\centering</span>
<span class="go">\begin{tabular}{ l r l }</span>
<span class="go">\hline</span>
<span class="go">\bf{one} &amp; \bf{two} &amp; \bf{three} \\</span>
<span class="go">\hline</span>
<span class="go">\hline</span>
<span class="go">230 &amp; acdef &amp; 1.3000 \\</span>
<span class="go">  6 &amp;    cc &amp; 1.9876 \\</span>
<span class="go">\hline</span>
<span class="go">\end{tabular}</span>
<span class="go">\caption{A legend}</span>
<span class="go">\label{table:test}</span>
<span class="go">\end{table}</span>
</pre></div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020, cogent3.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/examples/handling_tabular_data.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>